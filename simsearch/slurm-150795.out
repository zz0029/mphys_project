>>> Job started at Wed Nov 26 15:37:48 GMT 2025
>>> Running /share/nas2_3/yhuang/myrepo/mphys_project/simsearch/simsearch.py
/share/nas2_3/yhuang/byol/runscripts/venv/lib/python3.9/site-packages/umap/distances.py:1063: NumbaDeprecationWarning: The 'nopython' keyword argument was not supplied to the 'numba.jit' decorator. The implicit default value for this argument is currently False, but it will be changed to True in Numba 0.59.0. See https://numba.readthedocs.io/en/stable/reference/deprecation.html#deprecation-of-object-mode-fall-back-behaviour-when-using-jit for details.
  @numba.jit()
/share/nas2_3/yhuang/byol/runscripts/venv/lib/python3.9/site-packages/umap/distances.py:1071: NumbaDeprecationWarning: The 'nopython' keyword argument was not supplied to the 'numba.jit' decorator. The implicit default value for this argument is currently False, but it will be changed to True in Numba 0.59.0. See https://numba.readthedocs.io/en/stable/reference/deprecation.html#deprecation-of-object-mode-fall-back-behaviour-when-using-jit for details.
  @numba.jit()
/share/nas2_3/yhuang/byol/runscripts/venv/lib/python3.9/site-packages/umap/distances.py:1086: NumbaDeprecationWarning: The 'nopython' keyword argument was not supplied to the 'numba.jit' decorator. The implicit default value for this argument is currently False, but it will be changed to True in Numba 0.59.0. See https://numba.readthedocs.io/en/stable/reference/deprecation.html#deprecation-of-object-mode-fall-back-behaviour-when-using-jit for details.
  @numba.jit()
/share/nas2_3/yhuang/byol/runscripts/venv/lib/python3.9/site-packages/umap/umap_.py:660: NumbaDeprecationWarning: The 'nopython' keyword argument was not supplied to the 'numba.jit' decorator. The implicit default value for this argument is currently False, but it will be changed to True in Numba 0.59.0. See https://numba.readthedocs.io/en/stable/reference/deprecation.html#deprecation-of-object-mode-fall-back-behaviour-when-using-jit for details.
  @numba.jit()
/share/nas2_3/yhuang/byol/runscripts/venv/lib/python3.9/site-packages/umap/__init__.py:36: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
Lightning automatically upgraded your loaded checkpoint from v1.5.6 to v2.0.2. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint --file ../../../byol/runscripts/byol.ckpt`
Removing 49722 samples below angular size threshold.
Removed 1420 MiraBest samples from RGZ
(54858, 150, 150, 1)
Specified embedding file does not exist - will compute embedding
Embedding file NOT found. Computing features from RGZ (this may take a while).
Fitting reducer
  0%|          | 0/138 [00:00<?, ?it/s]  1%|          | 1/138 [00:15<35:57, 15.75s/it]  1%|▏         | 2/138 [00:15<14:57,  6.60s/it]  2%|▏         | 3/138 [00:16<08:15,  3.67s/it]  3%|▎         | 4/138 [00:16<05:06,  2.29s/it]  4%|▎         | 5/138 [00:16<03:23,  1.53s/it]  4%|▍         | 6/138 [00:16<02:21,  1.07s/it]  5%|▌         | 7/138 [00:16<01:42,  1.28it/s]  6%|▌         | 8/138 [00:17<01:16,  1.70it/s]  7%|▋         | 9/138 [00:17<00:59,  2.18it/s]  7%|▋         | 10/138 [00:17<00:47,  2.68it/s]  8%|▊         | 11/138 [00:17<00:39,  3.20it/s]  9%|▊         | 12/138 [00:17<00:34,  3.67it/s]  9%|▉         | 13/138 [00:17<00:30,  4.10it/s] 10%|█         | 14/138 [00:18<00:27,  4.46it/s] 11%|█         | 15/138 [00:18<00:25,  4.74it/s] 12%|█▏        | 16/138 [00:18<00:24,  4.97it/s] 12%|█▏        | 17/138 [00:18<00:23,  5.14it/s] 13%|█▎        | 18/138 [00:18<00:22,  5.26it/s] 14%|█▍        | 19/138 [00:18<00:22,  5.36it/s] 14%|█▍        | 20/138 [00:19<00:21,  5.44it/s] 15%|█▌        | 21/138 [00:19<00:21,  5.48it/s] 16%|█▌        | 22/138 [00:19<00:20,  5.53it/s] 17%|█▋        | 23/138 [00:19<00:20,  5.54it/s] 17%|█▋        | 24/138 [00:19<00:20,  5.54it/s] 18%|█▊        | 25/138 [00:20<00:20,  5.56it/s] 19%|█▉        | 26/138 [00:20<00:20,  5.56it/s] 20%|█▉        | 27/138 [00:20<00:20,  5.53it/s] 20%|██        | 28/138 [00:20<00:19,  5.54it/s] 21%|██        | 29/138 [00:20<00:19,  5.55it/s] 22%|██▏       | 30/138 [00:20<00:19,  5.55it/s] 22%|██▏       | 31/138 [00:21<00:19,  5.57it/s] 23%|██▎       | 32/138 [00:21<00:19,  5.58it/s] 24%|██▍       | 33/138 [00:21<00:18,  5.56it/s] 25%|██▍       | 34/138 [00:21<00:18,  5.56it/s] 25%|██▌       | 35/138 [00:21<00:18,  5.57it/s] 26%|██▌       | 36/138 [00:22<00:18,  5.55it/s] 27%|██▋       | 37/138 [00:22<00:18,  5.33it/s] 28%|██▊       | 38/138 [00:22<00:18,  5.40it/s] 28%|██▊       | 39/138 [00:22<00:18,  5.44it/s] 29%|██▉       | 40/138 [00:22<00:17,  5.48it/s] 30%|██▉       | 41/138 [00:22<00:17,  5.52it/s] 30%|███       | 42/138 [00:23<00:17,  5.52it/s] 31%|███       | 43/138 [00:23<00:17,  5.55it/s] 32%|███▏      | 44/138 [00:23<00:16,  5.55it/s] 33%|███▎      | 45/138 [00:23<00:16,  5.54it/s] 33%|███▎      | 46/138 [00:23<00:16,  5.54it/s] 34%|███▍      | 47/138 [00:24<00:16,  5.54it/s] 35%|███▍      | 48/138 [00:24<00:16,  5.54it/s] 36%|███▌      | 49/138 [00:24<00:16,  5.55it/s] 36%|███▌      | 50/138 [00:24<00:15,  5.57it/s] 37%|███▋      | 51/138 [00:24<00:15,  5.56it/s] 38%|███▊      | 52/138 [00:24<00:15,  5.56it/s] 38%|███▊      | 53/138 [00:25<00:15,  5.57it/s] 39%|███▉      | 54/138 [00:25<00:15,  5.55it/s] 40%|███▉      | 55/138 [00:25<00:14,  5.55it/s] 41%|████      | 56/138 [00:25<00:14,  5.56it/s] 41%|████▏     | 57/138 [00:25<00:14,  5.55it/s] 42%|████▏     | 58/138 [00:26<00:14,  5.57it/s] 43%|████▎     | 59/138 [00:26<00:14,  5.58it/s] 43%|████▎     | 60/138 [00:26<00:13,  5.57it/s] 44%|████▍     | 61/138 [00:26<00:13,  5.58it/s] 45%|████▍     | 62/138 [00:26<00:13,  5.58it/s] 46%|████▌     | 63/138 [00:26<00:13,  5.56it/s] 46%|████▋     | 64/138 [00:27<00:13,  5.56it/s] 47%|████▋     | 65/138 [00:27<00:13,  5.57it/s] 48%|████▊     | 66/138 [00:27<00:12,  5.54it/s] 49%|████▊     | 67/138 [00:27<00:12,  5.56it/s] 49%|████▉     | 68/138 [00:27<00:12,  5.57it/s] 50%|█████     | 69/138 [00:27<00:12,  5.56it/s] 51%|█████     | 70/138 [00:28<00:12,  5.57it/s] 51%|█████▏    | 71/138 [00:28<00:12,  5.57it/s] 52%|█████▏    | 72/138 [00:28<00:11,  5.56it/s] 53%|█████▎    | 73/138 [00:28<00:11,  5.57it/s] 54%|█████▎    | 74/138 [00:28<00:11,  5.57it/s] 54%|█████▍    | 75/138 [00:29<00:11,  5.56it/s] 55%|█████▌    | 76/138 [00:29<00:11,  5.56it/s] 56%|█████▌    | 77/138 [00:29<00:10,  5.57it/s] 57%|█████▋    | 78/138 [00:29<00:10,  5.57it/s] 57%|█████▋    | 79/138 [00:29<00:10,  5.57it/s] 58%|█████▊    | 80/138 [00:29<00:10,  5.58it/s] 59%|█████▊    | 81/138 [00:30<00:10,  5.56it/s] 59%|█████▉    | 82/138 [00:30<00:10,  5.56it/s] 60%|██████    | 83/138 [00:30<00:09,  5.56it/s] 61%|██████    | 84/138 [00:30<00:09,  5.55it/s] 62%|██████▏   | 85/138 [00:30<00:09,  5.56it/s] 62%|██████▏   | 86/138 [00:31<00:09,  5.54it/s] 63%|██████▎   | 87/138 [00:31<00:09,  5.55it/s] 64%|██████▍   | 88/138 [00:31<00:09,  5.55it/s] 64%|██████▍   | 89/138 [00:31<00:08,  5.56it/s] 65%|██████▌   | 90/138 [00:31<00:08,  5.54it/s] 66%|██████▌   | 91/138 [00:31<00:08,  5.55it/s] 67%|██████▋   | 92/138 [00:32<00:08,  5.55it/s] 67%|██████▋   | 93/138 [00:32<00:08,  5.55it/s] 68%|██████▊   | 94/138 [00:32<00:07,  5.55it/s] 69%|██████▉   | 95/138 [00:32<00:07,  5.56it/s] 70%|██████▉   | 96/138 [00:32<00:07,  5.55it/s] 70%|███████   | 97/138 [00:33<00:07,  5.56it/s] 71%|███████   | 98/138 [00:33<00:07,  5.56it/s] 72%|███████▏  | 99/138 [00:33<00:07,  5.55it/s] 72%|███████▏  | 100/138 [00:33<00:06,  5.56it/s] 73%|███████▎  | 101/138 [00:33<00:06,  5.56it/s] 74%|███████▍  | 102/138 [00:33<00:06,  5.55it/s] 75%|███████▍  | 103/138 [00:34<00:06,  5.56it/s] 75%|███████▌  | 104/138 [00:34<00:06,  5.56it/s] 76%|███████▌  | 105/138 [00:34<00:05,  5.56it/s] 77%|███████▋  | 106/138 [00:34<00:05,  5.56it/s] 78%|███████▊  | 107/138 [00:34<00:05,  5.55it/s] 78%|███████▊  | 108/138 [00:35<00:05,  5.54it/s] 79%|███████▉  | 109/138 [00:35<00:05,  5.55it/s] 80%|███████▉  | 110/138 [00:35<00:05,  5.56it/s] 80%|████████  | 111/138 [00:35<00:04,  5.54it/s] 81%|████████  | 112/138 [00:35<00:04,  5.57it/s] 82%|████████▏ | 113/138 [00:35<00:04,  5.56it/s] 83%|████████▎ | 114/138 [00:36<00:04,  5.56it/s] 83%|████████▎ | 115/138 [00:36<00:04,  5.56it/s] 84%|████████▍ | 116/138 [00:36<00:03,  5.55it/s] 85%|████████▍ | 117/138 [00:36<00:03,  5.54it/s] 86%|████████▌ | 118/138 [00:36<00:03,  5.54it/s] 86%|████████▌ | 119/138 [00:36<00:03,  5.55it/s] 87%|████████▋ | 120/138 [00:37<00:03,  5.54it/s] 88%|████████▊ | 121/138 [00:37<00:03,  5.55it/s] 88%|████████▊ | 122/138 [00:37<00:02,  5.57it/s] 89%|████████▉ | 123/138 [00:37<00:02,  5.56it/s] 90%|████████▉ | 124/138 [00:37<00:02,  5.57it/s] 91%|█████████ | 125/138 [00:38<00:02,  5.54it/s] 91%|█████████▏| 126/138 [00:38<00:02,  5.54it/s] 92%|█████████▏| 127/138 [00:38<00:01,  5.56it/s] 93%|█████████▎| 128/138 [00:38<00:01,  5.56it/s] 93%|█████████▎| 129/138 [00:38<00:01,  5.55it/s] 94%|█████████▍| 130/138 [00:38<00:01,  5.56it/s] 95%|█████████▍| 131/138 [00:39<00:01,  5.57it/s] 96%|█████████▌| 132/138 [00:39<00:01,  5.56it/s] 96%|█████████▋| 133/138 [00:39<00:00,  5.56it/s] 97%|█████████▋| 134/138 [00:39<00:00,  5.57it/s] 98%|█████████▊| 135/138 [00:39<00:00,  5.56it/s] 99%|█████████▊| 136/138 [00:40<00:00,  5.55it/s] 99%|█████████▉| 137/138 [00:40<00:00,  5.55it/s]100%|██████████| 138/138 [00:40<00:00,  3.42it/s]
torch.Size([54858, 512]) (54858,)
Performing transformation
Performing transformation
Performing transformation
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:00<00:00,  5.46it/s] 67%|██████▋   | 2/3 [00:00<00:00,  5.48it/s]100%|██████████| 3/3 [00:00<00:00,  6.12it/s]100%|██████████| 3/3 [00:00<00:00,  5.92it/s]
Performing transformation
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 28.44it/s]
ORC UMAP positions:
0 8.643205 0.73646
1 8.644211 0.72694457
2 8.635507 0.7372514
3 8.644957 0.7293667
4 8.633542 0.721006
5 8.629152 0.7384884
6 9.974958 2.680213
7 8.643561 0.7278664
===== ORC 最近 RGZ 邻居（在 UMAP 2D 空间）=====

ORC 0 at UMAP [8.643205 0.73646 ]
  #1: RGZ index 28711, UMAP=(8.6261, 0.7514), dist=0.0227
Traceback (most recent call last):
  File "/share/nas2_3/yhuang/myrepo/mphys_project/simsearch/simsearch.py", line 299, in <module>
    img_vis = img.clone() * sig + mu
TypeError: only integer tensors of a single element can be converted to an index
>>> Job finished at Wed Nov 26 15:47:28 GMT 2025
